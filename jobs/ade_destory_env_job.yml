parameters:
- name: adeObjects
  type: object
- name: serviceName
  type: string
  default: ''
- name: environmentName
  type: string
  default: cicd

jobs:
- job: '${{ parameters.serviceName }}_delete_ade'
  variables:
  - template: ../variables/azure_${{ parameters.environmentName }}_variables.yml
  steps:
  - ${{ each adeObject in parameters.adeObjects }} :
    - template: ../tasks/azcli_inline_script_task.yml
      parameters:
        displayName: 'Destroy ADE Environment'
        inlineScript: 'az devcenter dev environment delete --project-name ${{ adeObject.projectName }} --name ${{ parameters.serviceName }}${{ parameters.environmentName }} --yes --user-id ${{ variables.azureServiceConnectionUserID }}'
        azureSubscriptionName: ${{ variables.azureServiceConnectionName }}
